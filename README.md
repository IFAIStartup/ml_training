# ML Training

## Описание

Этот репозиторий содержит код для обучения нейросетевых моделей и разворачивания обученных модели с использованием MLFlow, Celery, Triton Server.

## Компоненты

- FastAPI: Для взаимодействия с приложением используется FastAPI.
- Celery Worker: Для проведения тренировки запускается Celery Worker через брокер сообщений RabbitMQ.
- MLFlow Server: Для логирования метрик и моделей поднимается MLFlow Server.
- Triton Server: Для деплоя натренированных моделей запускается Triton Server.

## Установка и использование
Следуйте этим шагам, чтобы настроить и запустить ваш проект для обучения нейросетевых моделей:

1. Подготовка данных:

- По умолчанию папка `./datasets` пробрасывается в контейнер, поэтому она используется в качестве хранилища входных датасетов. Поместите в нее [пример датасета](https://disk.yandex.ru/d/1EqFcYBCHdg_AQ) для возможности запуска обучения. Формат входных датасетов описан ниже.

2. В корневой папке проекта выполните:
```
docker-compose up
```
Это запустит все необходимые контейнеры.

3. Взаимодействие с приложением:
- Перейдите по адресу http://localhost:8181/docs# в вашем веб-браузере.
- Через Swagger-интерфейс можно выполнять запросы и тестировать функциональность вашего приложения.

4. Запуск тренировки:
- Передайте запрос эндпоинт `/train/` через FastAPI. Параметры по умолчанию зададут обучение 2 ранов: yolov8 и deeplabv3.
- Воркер в Celery начнет обработку входного датасета (в формате COCO) и запустит процесс тренировки.
Метрики и результаты будут логироваться в MLFlow.

5. Логирование в MLFlow:
- Перейдите в http://localhost:5000/, чтобы попасть в MLFlow Server для просмотра логирования тренировки. Логин и пароль администратора задается в `basic_auth.ini`


## Формат входного датасета
Ваш входной датасет должен быть организован следующим образом:

- Папка `images`: В этой папке должны находиться изображения, которые вы хотите использовать для обучения моделей. Изображения могут быть в формате JPEG, PNG или других поддерживаемых форматах. Названия файлов изображений могут быть произвольными, но рекомендуется следовать какой-то системе именования (например, по номерам или именам объектов на изображении).
- Папка `annotations`: В этой папке должен находиться файл instances_default.json. Этот файл содержит разметку объектов на изображениях в формате COCO (Common Objects in Context).


